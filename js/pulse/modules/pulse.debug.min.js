pulse.debug=pulse.debug||{};pulse.debug.tabs=pulse.debug.tabs||{};pulse.debug.getTypeColor=function(a){return a instanceof pulse.Scene?"248A8A":a instanceof pulse.Layer?"F2572A":a instanceof pulse.Sprite?"F9E555":a instanceof pulse.CanvasLabel?"FAAC38":a instanceof pulse.BitmapLabel?"C9FA58":"CCCCCC"};pulse.debug.Logger=PClass.extend({init:function(a){a=pulse.util.checkParams(a,{container:document.createElement("div")});this.container=a.container;this.container.className="pulse-debug-log";this.container.style.cssText="height: 118px; overflow: auto;";this.colors={error:"ff5c5c",warning:"ffcc66",debug:"ccc"};this.even=false},addMessage:function(a,b){var c=new Date,d=document.createElement("div");d.style.cssText="padding: 2px 0; border-bottom: 1px solid #555; padding:2px 5px;";d.style.color="#"+this.colors[b];
if(this.even)d.style.background="#2C2C2C";d.className="debug-log-message "+b;d.setAttribute("data-type",b);this.container.appendChild(d);var e=document.createElement("div");e.className="timestamp";e.style.cssText="float:left; width: 50px; margin-right: 5px;";var f=c.getHours()%12;e.innerHTML=(f===0?12:f)+":"+c.getMinutes()+":"+c.getSeconds();d.appendChild(e);c=document.createElement("span");c.className="text";c.innerHTML=a;d.appendChild(c);this.even=!this.even},filterType:function(a){for(var b=this.container.childNodes,
c=0;c<b.length;c++)b[c].style.display=b[c].getAttribute("data-type")==a?"block":"none"},clearFilter:function(){for(var a=this.container.childNodes,b=0;b<a.length;b++)a[b].style.display="block"}});pulse.debug.Timer=PClass.extend({init:function(a){a=pulse.util.checkParams(a,{name:"Timer"+pulse.debug.Timer.timerIdx++});this.name=a.name;this.timeCurrent=null;this.marks=[];this.marksMax=300;this.markCurrent=-1},start:function(){this.timeCurrent=(new Date).getTime()},mark:function(){var a=(new Date).getTime();this.marks.length>=this.marksMax&&this.marks.shift();this.markCurrent=a-this.timeCurrent;this.marks.push(this.markCurrent);this.timeCurrent=a}});pulse.debug.Timer.timerIdx=0;pulse.debug.FPS=pulse.debug.Timer.extend({init:function(a){this._super(a);this.frames=this.timeStart=0;this.fpsUpdateInterval=10;this.fps=0;this.fpsMarks=[];this._private={};this._private.timeLastSecond=-1},start:function(){this._super();this.timeStart=this._private.timeLastSecond=this.timeCurrent;this.fps=this.frames=0},mark:function(){this._super();this.frames++;if(this.timeCurrent>this._private.timeLastSecond+this.fpsUpdateInterval){for(var a=Math.round(this.frames*1E3/(this.timeCurrent-this._private.timeLastSecond)),
b=0,c=0;c<9;c++)b+=c===0?a/9:(this.fpsMarks[this.fpsMarks.length-1]||0)/9;this.fps=Math.round(b);this.fpsMarks.length>=this.marksMax&&this.fpsMarks.shift();this.fpsMarks.push(this.fps);this._private.timeLastSecond=this.timeCurrent;this.frames=0}}});pulse.debug.Counter=PClass.extend({init:function(a){a=pulse.util.checkParams(a,{name:"Counter"+pulse.debug.Counter.counterIdx++});this.name=a.name;this.count=0},reset:function(){this.count=0},increment:function(){this.count++},decrement:function(){this.count--}});pulse.debug.Counter.counterIdx=0;pulse.debug.PanelTab=PClass.extend({init:function(a){a=pulse.util.checkParams(a,{name:"Tab"+pulse.debug.Panel.tabIdx++,icon:"",id:"Tab"+(pulse.debug.Panel.tabIdx-1)});this.name=a.name;this.icon=a.icon;this.id=a.id;this.container=document.createElement("div");this.container.className="debug-tab";this.container.id="debug-tab-"+this.id;this.visible=false;this._private={}},show:function(){this.visible=true},hide:function(){this.visible=false},resize:function(){},update:function(){}});pulse.debug.tabs.Performance=pulse.debug.PanelTab.extend({init:function(a){this._super(a);a=pulse.util.checkParams(a,{fpsTimer:null,updateTimer:null,drawTimer:null});this.fpsTimer=a.fpsTimer;this.updateTimer=a.updateTimer;this.drawTimer=a.drawTimer;this._private.canvasWidth=window.innerWidth;this._private.heightIncrement=59;this._private.lastResize=118;this.canvas=document.createElement("canvas");this.canvas.width=this._private.canvasWidth;this.canvas.height=118;this.canvas.id="pulse-perf-graph";
this.container.appendChild(this.canvas);var b=this;window.onresize=function(){b._private.canvasWidth=window.innerWidth;b.resize(b.canvas.height+20)};this._private.context=this.canvas.getContext("2d");this._private.context.fillStyle="#333";this._private.context.fillRect(0,0,this._private.canvasWidth,118);this._private.msHeight=100;this._private.msRatio=this._private.msHeight/118;this.updateColor="61E561";this.drawColor="CC22EE";this.browserColor="F7Fd4A";this._private.stats=document.createElement("div");
this._private.stats.style.cssText="height: 14px;line-height:14px;padding:3px 5px;margin-top:-3px;";this.container.appendChild(this._private.stats);this._private.stats.appendChild(this.getLegendListing(this.updateColor));this._private.updateText=document.createElement("span");this._private.updateText.style.cssText="margin: 0 10px 0 5px";this._private.updateText.innerHTML="Update";this._private.stats.appendChild(this._private.updateText);this._private.stats.appendChild(this.getLegendListing(this.drawColor));
this._private.drawText=document.createElement("span");this._private.drawText.style.cssText="margin: 0 10px 0 5px";this._private.drawText.innerHTML="Draw";this._private.stats.appendChild(this._private.drawText);this._private.stats.appendChild(this.getLegendListing(this.browserColor));this._private.browserText=document.createElement("span");this._private.browserText.style.cssText="margin: 0 10px 0 5px";this._private.browserText.innerHTML="Browser";this._private.stats.appendChild(this._private.browserText)},
getLegendListing:function(a){var b=document.createElement("span");b.style.cssText="font-size: 14px; padding-left: 14px;background-color: #"+a+";";return b},show:function(){this._super()},hide:function(){this._super()},update:function(){this.drawGraph()},resize:function(a){var a=Math.round(a-20),b=document.createElement("canvas"),c=b.getContext("2d");b.width=this.canvas.width;b.height=a;c.fillStyle="#333";c.fillRect(0,0,this.canvas.width,a);var d=a-a%this._private.heightIncrement;d!==this._private.lastResize?
(this.canvas.height<d?c.drawImage(this.canvas,0,d-this._private.lastResize-(d-this.canvas.height),this.canvas.width,this._private.lastResize,0,a-d,this.canvas.width,d):c.drawImage(this.canvas,0,a-d,this.canvas.width,d),this._private.lastResize=d):c.drawImage(this.canvas,0,a-this.canvas.height);c=this._private.canvasWidth-this.canvas.width;this.canvas.height=a;this.canvas.width=this._private.canvasWidth;this._private.context.drawImage(b,c,0)},drawGraph:function(){var a=this.canvas.width-1,b=this._private.lastResize,
c=this.canvas.height-this._private.lastResize;this._private.msRatio=this._private.msHeight/b;this._private.context.drawImage(this.canvas,-1,0);this._private.context.fillStyle="#333";this._private.context.fillRect(a,0,1,this.canvas.height);var d,e=0,f=0;if(this.fpsTimer)d=Math.round(this.fpsTimer.markCurrent),e=d/this._private.msRatio,this._private.context.fillStyle="#"+this.browserColor,this._private.context.fillRect(a,b-e+c,1,e),f=d;if(this.updateTimer)d=Math.round(this.updateTimer.markCurrent),
e=d/this._private.msRatio,this._private.context.fillStyle="#"+this.updateColor,this._private.context.fillRect(a,b-e+c,1,e),f-=d,this._private.updateText.innerHTML="Update : "+d+"ms";if(this.drawTimer){d=Math.round(this.drawTimer.markCurrent);var g=e,e=d/this._private.msRatio;this._private.context.fillStyle="#"+this.drawColor;this._private.context.fillRect(a,b-e-g+c,1,e);f-=d;this._private.drawText.innerHTML="Draw : "+d+"ms"}this._private.browserText.innerHTML="Browser : "+f+"ms"}});pulse.debug.Panel=PClass.extend({init:function(a){var a=pulse.util.checkParams(a,{container:document.getElementsByTagName("body")[0],useDefault:true,fpsTimer:null,updateTimer:null,drawTimer:null,drawCounter:null,nodeCounter:null}),b=this;this.panel=document.createElement("div");this.panel.id="pulse-debug-panel";this.panel.style.cssText="width: 100%; background-color: #333; color: #00FF00;left: 0px; bottom: 0px; color: #ccc; font: 12px Helvetica,arial,freesans,clean,sans-serif; position: fixed;";a.container.appendChild(this.panel);
this.topbar=document.createElement("div");this.topbar.className="debug-topbar";this.topbar.style.cssText="height: 13px; line-height: 13px; font-size: 13px; padding: 5px;background-color: #222;cursor:ns-resize;";this.panel.appendChild(this.topbar);this.topbar.onmousedown=function(a){var c=a.pageY,f=b.panel.style.cssText;b.panel.style.cssText="-webkit-touch-callout: none; -webkit-user-select: none;-khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;"+f;var g=function(a){var d=
a.pageY-c,f=b.tabholder.style.height,f=f.substr(0,f.length-2),f=parseInt(f,10);b.resize(f-d);c=a.pageY};window.addEventListener("mousemove",g,false);window.addEventListener("mouseup",function(){b.panel.style.cssText=f;this.removeEventListener("mousemove",g,false);this.removeEventListener("mouseup",arguments.callee,false)},false)};var c=document.createElement("span");c.innerHTML="Pulse Debug";this.topbar.appendChild(c);this.tabbar=document.createElement("div");this.tabbar.className="debug-tabbar";
this.tabbar.style.cssText="height: 30px; background-color: #222; font-size: 14px;";this.panel.appendChild(this.tabbar);this.globalActions=document.createElement("div");this.globalActions.style.cssText="line-height: 30px; float: right;";this.tabbar.appendChild(this.globalActions);c=document.createElement("a");c.style.cssText="margin: 2px 5px; font-size: 12px; height: 16px; line-height: 16px; padding: 2px 6px; text-decoration: none; color: #EEE; display:block; border-radius: 3px; border: 1px solid #888; background: #666;";
c.innerHTML="VISUAL DEBUG";c.href="#";c.onclick=function(){if(pulse.debug&&pulse.debug.visualDebug!==void 0)pulse.debug.visualDebug===false?(pulse.debug.visualDebug=true,this.style.cssText+="background: #444;"):(pulse.debug.visualDebug=false,this.style.cssText+="background: #666;")};this.globalActions.appendChild(c);this.tabholder=document.createElement("div");this.tabholder.className="debug-tabholder";this.tabholder.style.cssText="height: 138px; overflow: hidden;";this.panel.appendChild(this.tabholder);
this.statusbar=document.createElement("div");this.statusbar.className="debug-statusbar";this.statusbar.style.cssText="height: 16px; line-height: 16px; padding: 2px 5px; overflow: hidden; background: #555;";this.panel.appendChild(this.statusbar);this.statusNodes=document.createElement("div");this.statusNodes.style.cssText="float: left; margin-right: 5px; padding-right: 5px; border-right: 1px solid #ccc;";this.statusbar.appendChild(this.statusNodes);this.statusDraws=document.createElement("div");this.statusDraws.style.cssText=
"float: left; margin-right: 5px; padding-right: 5px; border-right: 1px solid #ccc;";this.statusbar.appendChild(this.statusDraws);this.statusFPS=document.createElement("div");this.statusFPS.style.cssText="float: left; margin-right: 5px; padding-right: 5px; border-right: 1px solid #ccc;";this.statusbar.appendChild(this.statusFPS);this.statusMS=document.createElement("div");this.statusMS.style.cssText="float: left; margin-right: 5px; padding-right: 5px; border-right: 1px solid #ccc;border:0;";this.statusbar.appendChild(this.statusMS);
this.tabs={};this.tabbarLinks={};this.fpsTimer=a.fpsTimer;this.drawCounter=a.drawCounter;this.nodeCounter=a.nodeCounter;a.useDefault&&(a=new pulse.debug.tabs.Performance({name:"Performance",id:"perf",fpsTimer:a.fpsTimer,updateTimer:a.updateTimer,drawTimer:a.drawTimer}),this.addTab(a),this.addTab(new pulse.debug.tabs.Inspector({name:"Inspector",id:"inspector"})),this.addTab(new pulse.debug.tabs.Console({name:"Console",id:"console"})),this.showTab(a.id));this.offsetBody()},addTab:function(a){this.tabs[a.id]=
a;var b=this,c=document.createElement("a");c.href="#";c.innerHTML=a.name;c.onclick=function(){b.showTab(a.id);return false};c.id="pulse-tab-link-"+a.id;c.name=a.name;c.style.cssText="height: 30px; padding: 0px 10px; line-height: 30px; display: inline-block; text-decoration: none; color: #ccc;";a.icon!==""&&(c.style.cssText+="background: transparent url('"+a.icon+"') no-repeat 10px center;padding-left: 35px");a.container.style.display="none";this.tabbarLinks[a.id]=c;this.tabbar.appendChild(c);this.tabholder.appendChild(a.container)},
removeTab:function(a){this.tabs[a]&&(this.tabholder.removeChild(this.tabs[a]),this.tabbar.removeChild(this.tabbarLinks[a]),delete this.tabs[a],delete this.tabbarLinks[a])},showTab:function(a){for(var b in this.tabbarLinks)if(this.tabbarLinks[b].className!=="")this.tabbarLinks[b].className="",this.tabbarLinks[b].style.backgroundColor="",this.tabbarLinks[b].style.color="#ccc",this.tabs[b].container.className="debug-tab",this.tabs[b].hide();if(this.tabs[a])b=this.tabs[a],a=this.tabbarLinks[a],a.className=
"selected",a.style.backgroundColor="#333",a.style.color="#CCFF00",b.container.className="debug-tab selected",b.show()},resize:function(a){var b=document.getElementsByTagName("body")[0];b.style.minHeight=b.offsetHeight-this.panel.offsetHeight+"px";this.tabholder.style.height=a+"px";for(var c in this.tabs)this.tabs[c].resize(a);this.offsetBody()},offsetBody:function(){var a=document.getElementsByTagName("body")[0];a.style.minHeight=a.offsetHeight+this.panel.offsetHeight+"px"},logMessage:function(a,
b){this.tabs.console&&this.tabs.console.logMessage(a,b)},setEngine:function(a){this.tabs.inspector&&this.tabs.inspector.setEngine(a)},addNode:function(a){this.tabs.inspector&&this.tabs.inspector.addNode(a)},removeNode:function(a){this.tabs.inspector&&this.tabs.inspector.removeNode(a)},gameUpdated:function(){this.tabs.inspector&&this.tabs.inspector.update()},update:function(a){for(var b in this.tabs){if(this.tabs[b].visible===true)this.tabs[b].container.style.display="block";else if(this.tabs[b].container.style.display!==
"none")this.tabs[b].container.style.display="none";this.tabs[b].update(a)}if(this.fpsTimer)this.statusMS.innerHTML=Math.round(this.fpsTimer.markCurrent*100)/100+"ms",this.statusFPS.innerHTML="FPS: "+this.fpsTimer.fps;if(this.drawCounter)this.statusDraws.innerHTML="Draws: "+this.drawCounter.count;if(this.nodeCounter)this.statusNodes.innerHTML="Nodes: "+this.nodeCounter.count}});pulse.debug.Panel.tabIdx=0;pulse.debug.tabs.Console=pulse.debug.PanelTab.extend({init:function(a){this._super(a);this.selectedBGColor="555";this.toolbar=document.createElement("div");this.toolbar.className="debug-console-toolbar";this.toolbar.style.cssText="padding: 0 5px;line-height:20px;border-bottom: 1px solid #555;";this.container.appendChild(this.toolbar);this.allButton=this.addFilterButton("All","none");this.allButton.className="selected";this.allButton.style.backgroundColor="#"+this.selectedBGColor;this.errorsButton=
this.addFilterButton("Errors","error");this.warningsButton=this.addFilterButton("Warnings","warning");this.infoButton=this.addFilterButton("Info","debug");this.logger=new pulse.debug.Logger;this.container.appendChild(this.logger.container);this._private.currentFilterLink=this.allButton},addFilterButton:function(a,b){var c=this,d=document.createElement("a");d.onclick=function(){if(c._private.currentFilterLink)c._private.currentFilterLink.style.backgroundColor="";c._private.currentFilterLink=this;this.className=
"selected";this.style.backgroundColor="#"+c.selectedBGColor;b=="none"?c.clearFilter():c.filterLogs(b);return false};d.id="filter-"+b;d.href="#";d.innerHTML=a;d.style.cssText="text-decoration: none; color: #ccc; padding:2px 5px;";this.toolbar.appendChild(d);return d},logMessage:function(a,b){this.logger.addMessage(a,b)},filterLogs:function(a){this.logger.filterType(a)},clearFilter:function(){this.logger.clearFilter()},resize:function(a){this.logger.container.style.height=a-20+"px"}});pulse.debug.tabs.Inspector=pulse.debug.PanelTab.extend({init:function(a){this._super(a);this.selectedNode=null;this._private.nodeList=document.createElement("div");this._private.nodeList.style.cssText="overflow: auto; width: 70%; height: 120px; float: left; padding: 5px 0;";this.container.appendChild(this._private.nodeList);this._private.nodePropsDiv=document.createElement("div");this._private.nodePropsDiv.style.cssText="overflow: auto;width: 30%; height: 130px; float: right; padding: 5px 0; background: #3C3C3C";
this.container.appendChild(this._private.nodePropsDiv);var b=this,a=document.createElement("div");a.id="inspector-node-actions";a.style.cssText="float: right;";this.visibilityAction=document.createElement("a");this.visibilityAction.innerHTML="HIDE";this.visibilityAction.href="#";this.visibilityAction.style.cssText="float: left; margin: 0 5px; font-size: 12px; height: 16px; line-height: 16px; padding: 2px 6px; text-decoration: none; color: #EEE; display:block; border-radius: 3px; border: 1px solid #888; background: #666;";
this.visibilityAction.onclick=function(){b.selectedNode&&b.toggleNode(b.selectedNode);return false};a.appendChild(this.visibilityAction);this.outlineAction=document.createElement("a");this.outlineAction.innerHTML="OUTLINE";this.outlineAction.href="#";this.outlineAction.style.cssText="float: left; margin: 0 5px; font-size: 12px; height: 16px; line-height: 16px; padding: 2px 6px; text-decoration: none; color: #EEE; display:block; border-radius: 3px; border: 1px solid #888; background: #666;";this.outlineAction.onclick=
function(){b.selectedNode&&b.toggleDebug(b.selectedNode);return false};a.appendChild(this.outlineAction);this._private.nodePropsDiv.appendChild(a);this._private.nodeProps=["Name","Size","Position","Anchor","ZIndex"];var c,d,e;for(e in this._private.nodeProps)c=this._private.nodeProps[e],a=document.createElement("div"),a.id="inspector-props-"+c.toLowerCase(),a.style.cssText="padding: 2px 10px; color: #AAA;",a.innerHTML=c+": ",d=document.createElement("span"),d.id="inspector-prop-"+c.toLowerCase()+
"-value",d.style.cssText="color: #CCC;",a.appendChild(d),this._private.nodePropsDiv.appendChild(a);this._private.engine=null},show:function(){this._super()},hide:function(){this._super()},update:function(){this.selectedNode instanceof pulse.Visual&&this.selectedNode.updated===true&&this.selectNode(this.selectedNode)},setEngine:function(a){this._private.engine=a;for(var a=a.scenes.getScenes(true),b=0;b<a.length;b++)this.styleVisibility(a[b])},getNodeDiv:function(a,b,c){var d=document.createElement("div");
d.id="inspector-node-"+a.name;d.style.cssText="padding: 0 2px;";var e=document.createElement("span");e.className="name";e.style.cssText="cursor: pointer; padding: 2px;";e.innerHTML=a.name;var f=this;e.onclick=function(){f.selectNode(a)};var g=null;if(b===true){g=document.createElement("div");g.id="inspector-"+a.name+"-children";g.style.marginLeft=c+"px";g.style.display="none";var h=document.createElement("div");h.style.cssText="display: inline-block; width: 20px; height: 20px; font-size: 14px; cursor: pointer;";
h.onclick=function(){f.toggleVisibility(g);h.innerHTML=g.style.display==="block"?"&#9660;":"&#9658;"};h.innerHTML="&#9658;";d.appendChild(h);d.appendChild(e);d.appendChild(g);e.onclick=function(){f.selectNode(a)}}else d.appendChild(e);return{div:d,container:g}},addNode:function(a){a.debugging=false;var b=null;a.parent!==null&&(b=document.getElementById("inspector-"+a.parent.name+"-children"));var c=null;if(a instanceof pulse.Scene){c=this.getNodeDiv(a,true,10);this._private.nodeList.appendChild(c.div);
for(var d in a.layers)this.addNode(a.layers[d])}else if(a instanceof pulse.Layer&&b!==null){c=this.getNodeDiv(a,true,30);b.appendChild(c.div);for(var e in a.objects)this.addNode(a.objects[e])}else b!==null&&(c=this.getNodeDiv(a,false),b.appendChild(c.div));this.styleVisibility(a)},removeNode:function(a){var b=a;if(a instanceof pulse.Node)b=a.name;a=document.getElementById("inspector-node-"+b);a!==null&&a.parentNode.removeChild(a)},selectNode:function(a){var b;if(this.selectedNode!==null&&(b=document.getElementById("inspector-node-"+
this.selectedNode.name),b!==null)){var c=b.children[0];b.children[0].className!=="name"&&(c=b.children[1]);c.style.color=b.style.color;c.style.background="transparent"}this.selectedNode=a;b=document.getElementById("inspector-node-"+a.name);if(b!==null)c=b.children[0],b.children[0].className!=="name"&&(c=b.children[1]),c.style.background=b.style.color,c.style.color="#222";for(var d in this._private.nodeProps)if(b=this._private.nodeProps[d],c=document.getElementById("inspector-prop-"+b.toLowerCase()+
"-value"),c!==null)c.innerHTML=a.hasOwnProperty(b.toLowerCase())?this.getValueString(a[b.toLowerCase()]):"N/A";this.visibilityAction.innerHTML=a.visible===true||a.active===true?"HIDE":"SHOW";this.outlineAction.style.display=a instanceof pulse.Scene?"none":"block";this.outlineAction.style.cssText+=a.debugging?"background: #444;":"background: #666;"},toggleNode:function(a){a instanceof pulse.Scene&&this._private.engine instanceof pulse.Engine&&(a.active===true?this._private.engine.scenes.deactivateScene(a.name):
this._private.engine.scenes.activateScene(a.name));if(a instanceof pulse.Visual)a.visible=a.visible===true?false:true;this.styleVisibility(a);this.selectNode(a)},styleVisibility:function(a){var b=document.getElementById("inspector-node-"+a.name);if(b!==null){var c=pulse.debug.getTypeColor(a);if(a.visible===false||a.active===false)c=this.disableColor(c);b.highlightColor="#"+c;b.style.color="#"+c}},toggleDebug:function(a){a.debugging=a.debugging===true?false:true;this.selectNode(a)},toggleVisibility:function(a){a.style.display=
a.style.display!=="none"?"none":"block"},getValueString:function(a){var b="";if(typeof a==="object"){for(var c in a)b+=this.getValueString(a[c])+", ";b=b.substring(0,b.length-2)}else b+=typeof a==="number"?a.toFixed(2):a;return b},disableColor:function(a){var b=parseInt(a,16),a=(b&16711680)>>16,c=(b&65280)>>8,b=(b&255)>>0;a+=Math.floor(-100/255*a);c+=Math.floor(-100/255*c);b+=Math.floor(-100/255*b);return((a<<16)+(c<<8)+b).toString(16)},resize:function(a){this._private.nodeList.style.height=a+"px";
this._private.nodePropsDiv.style.height=a+"px"}});pulse.debug.DebugManager=PClass.extend({init:function(){this.timers={};this.counters={};this.fps=0;this.running=false;this._private={};this._private.fpsTimer=new pulse.debug.FPS;this._private.fpsTimer.start();this._private.updateTimer=new pulse.debug.Timer;this._private.drawTimer=new pulse.debug.Timer;this._private.drawCounter=new pulse.debug.Counter;this._private.nodeCounter=new pulse.debug.Counter;this.panel=null;this.setupPanel()},logWarning:function(a){this.panel.logMessage(a,"warning")},logDebug:function(a){this.panel.logMessage(a,
"debug")},logError:function(a){this.panel.logMessage(a,"error")},markTime:function(a){this.timers[a]?this.timers[a].mark():(this.timers[a]=new pulse.debug.DebugTimer({name:a}),this.timers[a].start())},markFPS:function(){this._private.fpsTimer.mark();this.fps=this._private.fpsTimer.fps},startUpdate:function(){this._private.updateTimer.start()},stopUpdate:function(){this._private.updateTimer.mark();this.panel.gameUpdated()},startDraw:function(){this._private.drawTimer.start()},stopDraw:function(){this._private.drawTimer.mark()},
resetDraws:function(){this._private.drawCounter.reset()},incrementDraws:function(){this._private.drawCounter.increment()},resetNodes:function(){this._private.nodeCounter.reset()},addNode:function(a){this._private.nodeCounter.increment();this.panel.addNode(a)},removeNode:function(a){this._private.nodeCounter.decrement();this.panel.removeNode(a)},setEngine:function(a){this.panel.setEngine(a)},setupPanel:function(){this.panel=new pulse.debug.Panel({fpsTimer:this._private.fpsTimer,updateTimer:this._private.updateTimer,
drawTimer:this._private.drawTimer,drawCounter:this._private.drawCounter,nodeCounter:this._private.nodeCounter})},update:function(a){this.panel.update(a)}});pulse.debug.visualDebug=false;pulse.ready(function(){pulse.debug.manager=new pulse.debug.DebugManager});pulse.debug.plugin=new pulse.plugin.Plugin;var loopCallback=pulse.debug.plugin.subscribe("pulse.Engine","loop",pulse.plugin.PluginCallbackTypes.onEnter,function(){pulse.debug.manager.setEngine(this);pulse.debug.plugin.unsubscribe(loopCallback)});pulse.debug.plugin.subscribe("pulse.Engine","update",pulse.plugin.PluginCallbackTypes.onEnter,function(){pulse.debug.manager.startUpdate()});
pulse.debug.plugin.subscribe("pulse.Engine","update",pulse.plugin.PluginCallbackTypes.onExit,function(){pulse.debug.manager.stopUpdate()});pulse.debug.plugin.subscribe("pulse.Engine","draw",pulse.plugin.PluginCallbackTypes.onEnter,function(){pulse.debug.manager.markFPS();pulse.debug.manager.resetDraws();pulse.debug.manager.startDraw()});pulse.debug.plugin.subscribe("pulse.Engine","draw",pulse.plugin.PluginCallbackTypes.onExit,function(){pulse.debug.manager.stopDraw();pulse.debug.manager.update(this.masterTime)});
pulse.debug.plugin.subscribe("pulse.Visual","update",pulse.plugin.PluginCallbackTypes.onExit,function(){pulse.debug.manager.stopUpdate();if(this.debugDrawn===void 0)this.debugDrawn=false;if((this.debugging===true||pulse.debug.visualDebug===true)&&this.debugDrawn===false||this.debugging===false&&pulse.debug.visualDebug===false&&this.debugDrawn===true)this.updated=true});
pulse.debug.plugin.subscribe("pulse.Visual","draw",pulse.plugin.PluginCallbackTypes.onEnter,function(){if(this.updated===true){if(this.debugging===true||pulse.debug.visualDebug===true)this.debugDrawn=false;pulse.debug.manager.incrementDraws()}});
pulse.debug.plugin.subscribe("pulse.Visual","draw",pulse.plugin.PluginCallbackTypes.onExit,function(a){if((this.debugging===true||pulse.debug.visualDebug===true)&&this.debugDrawn===false){var b="#"+pulse.debug.getTypeColor(this);a.save();a.fillStyle=b;a.beginPath();a.arc(this.positionTopLeft.x+this.canvas.width/2,this.positionTopLeft.y+this.canvas.height/2,3,0,Math.PI*2,true);a.closePath();a.fill();a.restore();a.strokeStyle=b;a.strokeRect(this.positionTopLeft.x/Math.abs(this.scale.x),this.positionTopLeft.y/
Math.abs(this.scale.y),this.size.width,this.size.height);this.debugDrawn=true}else if(this.debugDrawn===true)this.debugDrawn=false});pulse.debug.plugin.subscribe("pulse.Layer","addNode",pulse.plugin.PluginCallbackTypes.onExit,function(a){pulse.debug.manager.addNode(a)});pulse.debug.plugin.subscribe("pulse.Layer","removeNode",pulse.plugin.PluginCallbackTypes.onExit,function(a){pulse.debug.manager.removeNode(a)});
pulse.debug.plugin.subscribe("pulse.Scene","addLayer",pulse.plugin.PluginCallbackTypes.onExit,function(a){pulse.debug.manager.addNode(a)});pulse.debug.plugin.subscribe("pulse.Scene","removeLayer",pulse.plugin.PluginCallbackTypes.onExit,function(a){pulse.debug.manager.removeNode(a)});pulse.debug.plugin.subscribe("pulse.SceneManager","addScene",pulse.plugin.PluginCallbackTypes.onExit,function(a){pulse.debug.manager.addNode(a)});
pulse.debug.plugin.subscribe("pulse.SceneManager","removeScene",pulse.plugin.PluginCallbackTypes.onExit,function(a){pulse.debug.manager.removeNode(a)});pulse.plugins.add(pulse.debug.plugin);pulse.log=function(a,b){b==="error"?pulse.debug.manager.logError(a):b==="warning"?pulse.debug.manager.logWarning(a):pulse.debug.manager.logDebug(a)};pulse.info=function(a){pulse.debug.manager.logDebug(a)};pulse.warn=function(a){pulse.debug.manager.logWarning(a)};pulse.error=function(a){pulse.debug.manager.logError(a)};
